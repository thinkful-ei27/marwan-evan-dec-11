'use strict';

const MOCK_API = 
  {
    "kind": "youtube#searchListResponse",
    "etag": "\"XI7nbFXulYBIpL0ayR_gDh3eu1k/4OyhzeeFmlAV_pfURrsBovPWnVA\"",
    "nextPageToken": "CAUQAA",
    "regionCode": "JO",
    "pageInfo": {
     "totalResults": 1000000,
     "resultsPerPage": 5
    },
    "items": [
     {
      "kind": "youtube#searchResult",
      "etag": "\"XI7nbFXulYBIpL0ayR_gDh3eu1k/zxh4DMbo6RRvTNpGBQCBpzoY11U\"",
      "id": {
       "kind": "youtube#video",
       "videoId": "DXUAyRRkI6k"
      },
      "snippet": {
       "publishedAt": "2013-11-09T22:11:37.000Z",
       "channelId": "UCVUdHi-tdW5AKdzMiTPG97Q",
       "title": "Funny Cats and Kittens Meowing Compilation",
       "description": "Here is a video of cats and kittens meowing to confuse your pets Puppies & Babies & Kitties OH MY! New videos all the time! Subscribe: ...",
       "thumbnails": {
        "default": {
         "url": "https://i.ytimg.com/vi/DXUAyRRkI6k/default.jpg",
         "width": 120,
         "height": 90
        },
        "medium": {
         "url": "https://i.ytimg.com/vi/DXUAyRRkI6k/mqdefault.jpg",
         "width": 320,
         "height": 180
        },
        "high": {
         "url": "https://i.ytimg.com/vi/DXUAyRRkI6k/hqdefault.jpg",
         "width": 480,
         "height": 360
        }
       },
       "channelTitle": "funnyplox",
       "liveBroadcastContent": "none"
      }
     },
     {
      "kind": "youtube#searchResult",
      "etag": "\"XI7nbFXulYBIpL0ayR_gDh3eu1k/JbjEQM-u8awv40tG85PqWRyVIEg\"",
      "id": {
       "kind": "youtube#video",
       "videoId": "hrxR6sFiq04"
      },
      "snippet": {
       "publishedAt": "2018-05-23T15:00:03.000Z",
       "channelId": "UCejVe2sNPjjvfCXg35q_EQQ",
       "title": "Baby Cats ðŸ”´ Funny and Cute Baby Cat Videos Compilation (2018) Gatitos Bebes Video Recopilacion",
       "description": "Baby Cats - Funny and Cute Baby Cat Videos Compilation (2018) Gatitos Bebes Video RecopilaciÃ³n | Animal Planet Videos ðŸ¦„ Subscribe Here: ...",
       "thumbnails": {
        "default": {
         "url": "https://i.ytimg.com/vi/hrxR6sFiq04/default.jpg",
         "width": 120,
         "height": 90
        },
        "medium": {
         "url": "https://i.ytimg.com/vi/hrxR6sFiq04/mqdefault.jpg",
         "width": 320,
         "height": 180
        },
        "high": {
         "url": "https://i.ytimg.com/vi/hrxR6sFiq04/hqdefault.jpg",
         "width": 480,
         "height": 360
        }
       },
       "channelTitle": "Animal Planet Videos",
       "liveBroadcastContent": "none"
      }
     },
     {
      "kind": "youtube#searchResult",
      "etag": "\"XI7nbFXulYBIpL0ayR_gDh3eu1k/CIzHxn5Tg3A4s2nJ1YNkNe9bwj8\"",
      "id": {
       "kind": "youtube#video",
       "videoId": "hY7m5jjJ9mM"
      },
      "snippet": {
       "publishedAt": "2017-05-31T09:30:02.000Z",
       "channelId": "UC9obdDRxQkmn_4YpcBMTYLw",
       "title": "CATS will make you LAUGH YOUR HEAD OFF - Funny CAT compilation",
       "description": "Cats are amazing creatures because they make us laugh all the time! Watching funny cats is the hardest try not to laugh challenge! Just look how all these cats ...",
       "thumbnails": {
        "default": {
         "url": "https://i.ytimg.com/vi/hY7m5jjJ9mM/default.jpg",
         "width": 120,
         "height": 90
        },
        "medium": {
         "url": "https://i.ytimg.com/vi/hY7m5jjJ9mM/mqdefault.jpg",
         "width": 320,
         "height": 180
        },
        "high": {
         "url": "https://i.ytimg.com/vi/hY7m5jjJ9mM/hqdefault.jpg",
         "width": 480,
         "height": 360
        }
       },
       "channelTitle": "Tiger FunnyWorks",
       "liveBroadcastContent": "none"
      }
     },
     {
      "kind": "youtube#searchResult",
      "etag": "\"XI7nbFXulYBIpL0ayR_gDh3eu1k/JNFhvb0DfB4s58uFOcCGKqXcETo\"",
      "id": {
       "kind": "youtube#video",
       "videoId": "o5mjXnk-m1A"
      },
      "snippet": {
       "publishedAt": "2018-12-08T23:54:45.000Z",
       "channelId": "UCeL2LSl91k2VccR7XEh5IKg",
       "title": "LIVE: Rescued pregnant feral cat + kittens - TinyKittens.com",
       "description": "Our rescue work: http://tinykittens.com Get updates on facebook: http://fb.com/tinykittens Our VIP livestream: http://vip.tinykittens.com Donate: ...",
       "thumbnails": {
        "default": {
         "url": "https://i.ytimg.com/vi/o5mjXnk-m1A/default_live.jpg",
         "width": 120,
         "height": 90
        },
        "medium": {
         "url": "https://i.ytimg.com/vi/o5mjXnk-m1A/mqdefault_live.jpg",
         "width": 320,
         "height": 180
        },
        "high": {
         "url": "https://i.ytimg.com/vi/o5mjXnk-m1A/hqdefault_live.jpg",
         "width": 480,
         "height": 360
        }
       },
       "channelTitle": "TinyKittens HQ",
       "liveBroadcastContent": "live"
      }
     },
     {
      "kind": "youtube#searchResult",
      "etag": "\"XI7nbFXulYBIpL0ayR_gDh3eu1k/u2n3wez7ljBkwPSV6WkGrkhsBlI\"",
      "id": {
       "kind": "youtube#video",
       "videoId": "5dsGWM5XGdg"
      },
      "snippet": {
       "publishedAt": "2016-12-24T10:30:00.000Z",
       "channelId": "UCKy3MG7_If9KlVuvw3rPMfw",
       "title": "Cats are so funny you will die laughing - Funny cat compilation",
       "description": "Cats are simply the funniest and most hilarious pets, they make us laugh all the time! Just look how all these cats & kittens play, fail, get along with dogs and ...",
       "thumbnails": {
        "default": {
         "url": "https://i.ytimg.com/vi/5dsGWM5XGdg/default.jpg",
         "width": 120,
         "height": 90
        },
        "medium": {
         "url": "https://i.ytimg.com/vi/5dsGWM5XGdg/mqdefault.jpg",
         "width": 320,
         "height": 180
        },
        "high": {
         "url": "https://i.ytimg.com/vi/5dsGWM5XGdg/hqdefault.jpg",
         "width": 480,
         "height": 360
        }
       },
       "channelTitle": "Tiger Productions",
       "liveBroadcastContent": "none"
      }
     }
    ]
   }
   



const API_KEY = 'AIzaSyDgwDsmtKujjcLVeq_ZQhveaOjQIoeeCgE';

/*
  We want our store to hold an array of "decorated" video objects - i.e. objects that
  have been transformed into ONLY the necessary data we're displaying on our page. 
  (Removes extraneous dataset from Youtube.)
  
  Example decorated video object:
  
  {
    id: '98ds8fbsdy67',
    title: 'Cats dancing the Macarena',
    thumbnail: 'https://img.youtube.com/some/thumbnail.jpg'
  }
*/
const store = {
  videos: [

  ]
};

// TASK: Add the Youtube Search API Base URL here:
// Documentation is here: https://developers.google.com/youtube/v3/docs/search/list#usage
const BASE_URL = 'https://www.googleapis.com/youtube/v3/search';

/**
 * @function fetchVideos
 * Async function, responsible for calling the Youtube API with jQuery, constructing
 * the correct query object, and passing along the callback into the AJAX call.
 * @param {string}   searchTerm
 * @param {function} callback
 */
// TASK:
// 1. Use `searchTerm` to construct the right query object based on the Youtube API docs
//    - Refer to curriculum assignment for help with the required parameters
// 2. Make a getJSON call using the query object and sending the provided callback in 
//    as the last argument
//
// TEST IT! Execute this function and console log the results inside the callback.
const fetchVideos = function (searchTerm, callback) {
  const youQuery = {
    q: searchTerm,
    key: API_KEY,
    part: 'snippet'
  };
  $.getJSON(BASE_URL, youQuery, callback)
};

// fetchVideos('cat', function (res) {
//   console.log(res);
// })

/**
 * @function decorateResponse
 * Uses Youtube API response to create an array of "decorated" video objects as 
 * defined at the top of the file.
 * @param   {object} response - should match Youtube API response shape
 * @returns {array}
 */
// TASK:
// 1. Map through the response object's `items` array
// 2. Return an array of objects, where each object contains the keys `id`, `title`, 
//    `thumbnail` which each hold the appropriate values from the API item object. You 
//    WILL have to dig into several nested properties!
//
// TEST IT! Grab an example API response and send it into the function - make sure
// you get back the object you want.
const decorateResponse = function (response) {
  return response.items.map(item => {
    return  {
      id: item.id.videoId,
      title: item.snippet.title,
      thumbnail: item.snippet.thumbnails.default.url
    };
  });
};


/**
 * @function generateVideoItemHtml
 * Template function, creates an HTML string from a single decorated video object
 * @param   {object} video - decorated video object
 * @returns {string} HTML 
 */
// TASK:
// 1. Using the decorated object, return an HTML string containing all the expected
// TEST IT!
const generateVideoItemHtml = function (video) {

};

/**
 * @function addVideosToStore
 * Store modification function to set decorated video objects
 * @param {array} videos - decorated video objects
 */
// TASK:
// 1. Set the received array as the value held in store.videos
// TEST IT!
const addVideosToStore = function (videos) {

};


/**
 * @function render
 * Responsible for scanning store and rendering the video list to DOM
 */
// TASK:
// 1. Map through `store.videos`, sending each `video` through `generateVideoItemHtml`
// 2. Add this array of DOM elements to the appropriate DOM element
// TEST IT!
const render = function () {

};

/**
 * @function handleFormSubmit
 * Adds form "submit" event listener that 1) initiates API call, 2) modifies store,
 * and 3) invokes render
 */
// TASK:
// 2. Add an event listener to the form that will:
//   a) Prevent default event
//   b) Retrieve the search input from the DOM
//   c) Clear the search input field
//   d) Invoke the `fetchVideos` function, sending in the search value
//   e) Inside the callback, send the API response through the `decorateResponse` function
//   f) Inside the callback, add the decorated response into your store using the 
//      `addVideosToStore` function
//   g) Inside the callback, run the `render` function 
// TEST IT!
const handleFormSubmit = function () {

};

// When DOM is ready:
$(function () {
  // TASK:
  // 1. Run `handleFormSubmit` to bind the event listener to the DOM
});